<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wei Guo" />

<meta name="date" content="2020-03-31" />

<title>postGGIR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">postGGIR</h1>
<h4 class="author">Wei Guo</h4>
<h4 class="date">March 31, 2020</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="what-is-ggir" class="section level2">
<h2>What is GGIR?</h2>
<p><a href="https://CRAN.R-project.org/package=GGIR">GGIR</a> is an R-package to process multi-day raw accelerometer data for physical activity and sleep research. GGIR will write all output files into two sub-directories of ./meta and ./results. GGIR is increasingly being used by a number of academic institutes across the world.</p>
</div>
<div id="what-is-postggir" class="section level2">
<h2>What is postGGIR?</h2>
<p><a href="https://github.com/dora201888/postGGIR">postGGIR</a> is an R-package to data processing after running GGIR for accelerometer data. In detail, all necessary R/Rmd/shell files were generated for data processing after running GGIR for accelerometer data. Then in part 1, all csv files in the GGIR output directory were read, transformed and then merged. In part 2, the GGIR output files were checked and summarized in one excel sheet. In part 3, the merged data was cleaned according to the number of valid hours on each night and the number of valid days for each subject. In part 4, the cleaned activity data was imputed by the average ENMO over all the valid days for each subject. Finally, a comprehensive report of data processing was created using Rmarkdown, and the report includes few explortatory plots and multiple commonly used features extracted from minute level actigraphy data in part 5-7. This vignette provides a general introduction to postGGIR.</p>
</div>
</div>
<div id="setting-up-your-work-environment" class="section level1">
<h1>Setting up your work environment</h1>
<div id="install-r-and-rstudio" class="section level2">
<h2>Install R and RStudio</h2>
<p><a href="https://cran.r-project.org/">Download and install R</a></p>
<p><a href="https://www.rstudio.com/products/rstudio">Download and install RStudio</a> (optional, but recommended)</p>
<p>To download the package from Github</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;junruidi/actigraphy&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;dora201888/postGGIR&quot;</span>)</span></code></pre></div>
</div>
<div id="prepare-folder-structure" class="section level2">
<h2>Prepare folder structure</h2>
<ol style="list-style-type: decimal">
<li>folder of .bin files for GGIR or a file listing all .bin files
<ul>
<li>R program will check the missing in the GGIR output by comparing with all raw .bin files</li>
</ul></li>
<li>foder of the GGIR output with two sub-folders
<ul>
<li>meta (./basic, ./csv, etc)<br />
</li>
<li>results (part<em>summary</em>.csv)</li>
</ul></li>
</ol>
</div>
</div>
<div id="quick-start" class="section level1">
<h1>Quick start</h1>
<div id="create-a-template-shell-script-of-postggir" class="section level2">
<h2>Create a template shell script of postGGIR</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(postGGIR)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">create.postGGIR</span>()</span></code></pre></div>
<p>The function will create a template shell script of postGGIR in the current directory, names as <em>XXX_ggir9s_afterGGIR.pipeline.maincall.R</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">cat</span> XXX_ggir9s_afterGGIR.pipeline.maincall.R</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">options</span>(<span class="dt">width=</span><span class="dv">2000</span>) </span>
<span id="cb4-2"><a href="#cb4-2"></a>argv =<span class="st"> </span><span class="kw">commandArgs</span>(<span class="ot">TRUE</span>);  </span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">print</span>(argv) </span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;length=&quot;</span>,<span class="kw">length</span>(argv),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))  </span>
<span id="cb4-5"><a href="#cb4-5"></a>mode&lt;-<span class="kw">as.numeric</span>(argv[<span class="dv">1</span>])  </span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="st">&quot;mode =&quot;</span>, mode))</span>
<span id="cb4-7"><a href="#cb4-7"></a> </span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#########################################################################  </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># (user-define 1) you got to redefine this according different study!!!!</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">######################################################################### </span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># colaus </span></span>
<span id="cb4-12"><a href="#cb4-12"></a>filename2id&lt;-<span class="cf">function</span>(x) {</span>
<span id="cb4-13"><a href="#cb4-13"></a>  y1&lt;-<span class="kw">unlist</span>(<span class="kw">strsplit</span>(x,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">_&quot;</span>))[<span class="dv">1</span>]</span>
<span id="cb4-14"><a href="#cb4-14"></a>  y2&lt;-<span class="kw">unlist</span>(<span class="kw">strsplit</span>(y1,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>))[<span class="dv">1</span>]</span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="kw">return</span>(y2)</span>
<span id="cb4-16"><a href="#cb4-16"></a>} </span>
<span id="cb4-17"><a href="#cb4-17"></a> </span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co"># nimh (use csv file =c(&quot;filename&quot;,&quot;ggirID&quot;)) </span></span>
<span id="cb4-19"><a href="#cb4-19"></a>filename2id&lt;-<span class="cf">function</span>(x) {</span>
<span id="cb4-20"><a href="#cb4-20"></a>  d&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;./postGGIR/inst/example/filename2id.csv&quot;</span>,<span class="dt">head=</span><span class="dv">1</span>,<span class="dt">stringsAsFactors=</span>F)</span>
<span id="cb4-21"><a href="#cb4-21"></a>  y1&lt;-<span class="kw">which</span>(d[,<span class="st">&quot;filename&quot;</span>]<span class="op">==</span>x)</span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="cf">if</span> (<span class="kw">length</span>(y1)<span class="op">==</span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="kw">paste</span>(<span class="st">&quot;Missing &quot;</span>,x,<span class="st">&quot; in filename2id.csv file&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb4-23"><a href="#cb4-23"></a>  <span class="cf">if</span> (<span class="kw">length</span>(y1)<span class="op">&gt;=</span><span class="dv">1</span>) y2&lt;-d[y1[<span class="dv">1</span>],<span class="st">&quot;newID&quot;</span>] </span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="kw">return</span>(<span class="kw">as.character</span>(y2))</span>
<span id="cb4-25"><a href="#cb4-25"></a>} </span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">#########################################################################  </span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">#  main call</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">######################################################################### </span></span>
<span id="cb4-31"><a href="#cb4-31"></a>  </span>
<span id="cb4-32"><a href="#cb4-32"></a>call.afterggir&lt;-<span class="cf">function</span>(mode,<span class="dt">rmDup=</span><span class="ot">FALSE</span>){ </span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="kw">library</span>(postGGIR) </span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="co">#################################################   </span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="co"># (user-define 2) Fill in parameters of your ggir output</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="co">#################################################  </span></span>
<span id="cb4-38"><a href="#cb4-38"></a>currentdir =<span class="st"> </span></span>
<span id="cb4-39"><a href="#cb4-39"></a>studyname =</span>
<span id="cb4-40"><a href="#cb4-40"></a>bindir =</span>
<span id="cb4-41"><a href="#cb4-41"></a>binfile.list =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>outputdir =<span class="st"> </span></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="st"> </span></span>
<span id="cb4-44"><a href="#cb4-44"></a>epochIn =<span class="st"> </span><span class="dv">5</span></span>
<span id="cb4-45"><a href="#cb4-45"></a>epochOut =<span class="st"> </span><span class="dv">5</span></span>
<span id="cb4-46"><a href="#cb4-46"></a>flag.epochOut =<span class="st"> </span><span class="dv">60</span></span>
<span id="cb4-47"><a href="#cb4-47"></a>use.cluster =<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>log.multiplier =<span class="st"> </span><span class="dv">9250</span></span>
<span id="cb4-49"><a href="#cb4-49"></a>QCdays.alpha =<span class="st"> </span><span class="dv">7</span></span>
<span id="cb4-50"><a href="#cb4-50"></a>QChours.alpha =<span class="st"> </span><span class="dv">16</span> </span>
<span id="cb4-51"><a href="#cb4-51"></a>useIDs.FN&lt;-<span class="ot">NULL</span> </span>
<span id="cb4-52"><a href="#cb4-52"></a><span class="kw">setwd</span>(currentdir) </span>
<span id="cb4-53"><a href="#cb4-53"></a><span class="co">#########################################################################  </span></span>
<span id="cb4-54"><a href="#cb4-54"></a><span class="co">#   remove duplicate sample IDs for plotting and feature extraction </span></span>
<span id="cb4-55"><a href="#cb4-55"></a><span class="co">######################################################################### </span></span>
<span id="cb4-56"><a href="#cb4-56"></a><span class="cf">if</span> (mode<span class="op">==</span><span class="dv">3</span> <span class="op">&amp;</span><span class="st"> </span>rmDup){</span>
<span id="cb4-57"><a href="#cb4-57"></a><span class="co"># step 1: read ./summary/*remove_temp.csv file (output of mode=2)</span></span>
<span id="cb4-58"><a href="#cb4-58"></a>keep.last&lt;-<span class="ot">TRUE</span> <span class="co">#keep the latest visit for each sample</span></span>
<span id="cb4-59"><a href="#cb4-59"></a>sumdir&lt;-<span class="kw">paste</span>(currentdir,<span class="st">&quot;/summary&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)  </span>
<span id="cb4-60"><a href="#cb4-60"></a><span class="kw">setwd</span>(sumdir)  </span>
<span id="cb4-61"><a href="#cb4-61"></a>inFN&lt;-<span class="kw">paste</span>(studyname,<span class="st">&quot;_samples_remove_temp.csv&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb4-62"><a href="#cb4-62"></a>useIDs.FN&lt;-<span class="kw">paste</span>(sumdir,<span class="st">&quot;/&quot;</span>,studyname,<span class="st">&quot;_samples_remove.csv&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)  </span>
<span id="cb4-63"><a href="#cb4-63"></a></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="co">#################################################   </span></span>
<span id="cb4-65"><a href="#cb4-65"></a><span class="co"># (user-define 3 as rmDup=TRUE)  create useIDs.FN file</span></span>
<span id="cb4-66"><a href="#cb4-66"></a><span class="co">#################################################  </span></span>
<span id="cb4-67"><a href="#cb4-67"></a><span class="co"># step 2: create the ./summary/*remove.csv file manually or by R commands</span></span>
<span id="cb4-68"><a href="#cb4-68"></a>d&lt;-<span class="kw">read.csv</span>(inFN,<span class="dt">head=</span><span class="dv">1</span>,<span class="dt">stringsAsFactors=</span>F)</span>
<span id="cb4-69"><a href="#cb4-69"></a>d&lt;-d[<span class="kw">order</span>(d[,<span class="st">&quot;Date&quot;</span>]),]</span>
<span id="cb4-70"><a href="#cb4-70"></a>d&lt;-d[<span class="kw">order</span>(d[,<span class="st">&quot;newID&quot;</span>]),]</span>
<span id="cb4-71"><a href="#cb4-71"></a>d[<span class="kw">which</span>(<span class="kw">is.na</span>(d[,<span class="st">&quot;newID&quot;</span>])),]</span>
<span id="cb4-72"><a href="#cb4-72"></a>S&lt;-<span class="kw">duplicated</span>(d[,<span class="st">&quot;newID&quot;</span>],<span class="dt">fromLast=</span>keep.last) <span class="co">#keep the last copy for nccr</span></span>
<span id="cb4-73"><a href="#cb4-73"></a>d[S,<span class="st">&quot;duplicate&quot;</span>]&lt;-<span class="st">&quot;remove&quot;</span></span>
<span id="cb4-74"><a href="#cb4-74"></a><span class="kw">write.csv</span>(d,<span class="dt">file=</span>useIDs.FN,<span class="dt">row.names=</span>F) </span>
<span id="cb4-75"><a href="#cb4-75"></a>}  </span>
<span id="cb4-76"><a href="#cb4-76"></a><span class="co">#########################################################################  </span></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="co">#  maincall</span></span>
<span id="cb4-78"><a href="#cb4-78"></a><span class="co">#########################################################################  </span></span>
<span id="cb4-79"><a href="#cb4-79"></a><span class="kw">setwd</span>(currentdir)  </span>
<span id="cb4-80"><a href="#cb4-80"></a><span class="kw">afterggir</span>(<span class="dt">mode=</span>mode,useIDs.FN,currentdir,studyname,bindir,</span>
<span id="cb4-81"><a href="#cb4-81"></a>outputdir,epochIn,epochOut,flag.epochOut,log.multiplier,use.cluster,<span class="dt">QCdays.alpha=</span>QCdays.alpha,<span class="dt">QChours.alpha=</span>QChours.alpha) </span>
<span id="cb4-82"><a href="#cb4-82"></a>} </span>
<span id="cb4-83"><a href="#cb4-83"></a><span class="co">##############################################</span></span>
<span id="cb4-84"><a href="#cb4-84"></a><span class="kw">call.afterggir</span>(mode)   </span>
<span id="cb4-85"><a href="#cb4-85"></a><span class="co">##############################################  </span></span>
<span id="cb4-86"><a href="#cb4-86"></a><span class="co">#   Note:   call.afterggir(mode=0)</span></span>
<span id="cb4-87"><a href="#cb4-87"></a><span class="co">#        mode =0 : creat sw/Rmd file</span></span>
<span id="cb4-88"><a href="#cb4-88"></a><span class="co">#        mode =1 : data transform using cluster or not</span></span>
<span id="cb4-89"><a href="#cb4-89"></a><span class="co">#        mode =2 : summary</span></span>
<span id="cb4-90"><a href="#cb4-90"></a><span class="co">#        mode =3 : clean </span></span>
<span id="cb4-91"><a href="#cb4-91"></a><span class="co">#        mode =4 : impu</span></span></code></pre></div>
</div>
<div id="edit-shell-script" class="section level2">
<h2>Edit shell script</h2>
<p>Three places were marked as “user-define” and need to be edited by user in the <em>XXX_ggir9s_afterGGIR.pipeline.maincall.R</em> file. Please rename the file by replacing XXX with studyname after the edition.</p>
<div id="define-the-function-filename2id" class="section level3">
<h3>1. Define the function filename2id( )</h3>
<p>This user-defined function will change the filename of the raw accelerometer file to the short ID. For example, the first example change &quot;0002__026907_2016-03-11 13-05-59.bin&quot; to new ID of “0002”. If you prefer to define new ID by other way, you could create a .CSV file including “filename” and “newID” at least and then defined this function as the second example. The new variable of “newID”, included in the output files, could be used as the key ID in the summary report of postGGIR and be used to define the duplicate samples as well.</p>
</div>
<div id="parameters-of-shell-script" class="section level3">
<h3>2. Parameters of shell script</h3>
<p>User needs to define the following parameters as follows,</p>
<table>
<colgroup>
<col width="24%"></col>
<col width="75%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>currentdir</td>
<td>Directory where the output needs to be stored. Note that this directory must exist</td>
</tr>
<tr class="even">
<td>studyname</td>
<td>Specify the study name that used in the output file names. Give this variable an appropriate name as it will be used later to specify output file names.</td>
</tr>
<tr class="odd">
<td>bindir</td>
<td>Directory where the accelerometer files are stored or list</td>
</tr>
<tr class="even">
<td>binfile.list</td>
<td>File list of bin files when running GGIR. Default is NULL, but it has to be a filename in the .csv format when bindir=NULL.</td>
</tr>
<tr class="odd">
<td>outputdir</td>
<td>Directory where the GGIR output was stored.</td>
</tr>
<tr class="even">
<td>epochIn</td>
<td>Epoch size to which acceleration was averaged (seconds) in GGIR output. Defaut is 5 seconds.</td>
</tr>
<tr class="odd">
<td>epochOut</td>
<td>Epoch size to which acceleration was averaged (seconds) in part1. Defaut is 5 seconds.</td>
</tr>
<tr class="even">
<td>flag.epochOut</td>
<td>Epoch size to which acceleration was averaged (seconds) in part 3. Defaut is 60 seconds.</td>
</tr>
<tr class="odd">
<td>log.multiplier</td>
<td>The coefficient used in the log transformation of the ENMO data, i.e. log( log.multiplier * ENMO + 1), which have been used in part2a_postGGIR.report and part5. Defaut is 9250.</td>
</tr>
<tr class="even">
<td>use.cluster</td>
<td>Specify if part1 will be done by parallel computing. Default is TRUE, and the CSV file in GGIR output will be merged for every 20 files first, and then combined for all.</td>
</tr>
<tr class="odd">
<td>QCdays.alpha</td>
<td>Minimum required number of valid days in subject specific analysis as a quality control step in part2. Default is 7 days.</td>
</tr>
<tr class="even">
<td>QChours.alpha</td>
<td>Minimum required number of valid hours in day specific analysis as a quality control step in part2. Default is 16 hours.</td>
</tr>
</tbody>
</table>
</div>
<div id="subset-of-samples-optional" class="section level3">
<h3>3. Subset of samples (optional)</h3>
<p>The postGGIR package not only simply transform/merge the activity and sleep data, but it also can do some prelimary data analysis such as principle componet analysis and feature extraction. Therefore, the basic data clean will be processed first as follows,</p>
<ul>
<li>data clean by removing valid days/samples defined by minimum required number of valid hours/days in the activity data<br />
</li>
<li>remove duplicate samples</li>
</ul>
<p>If you prefer to use all samples, just skip this part and use <code>rmDup=FALSE</code> as the default. Otherwise, if you want to remove some samples such as duplicates, there are two ways as follows,</p>
<ul>
<li>Edit R codes of “step 2” in this part. For example, the template will keep the later copy for duplicate samples<br />
</li>
<li>Remove R codes of “step 2” in this part, and create <em>studyname_samples_remove.csv</em> file by filling “remove” in the “duplicate” column in the template file of <em>studyname_samples_remove_temp.csv</em>. The data will be kept unless duplicate=“remove”.</li>
</ul>
</div>
</div>
<div id="run-r-script" class="section level2">
<h2>Run R script</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">call.afterggir</span>(mode,<span class="dt">rmDup=</span><span class="ot">FALSE</span>)   </span></code></pre></div>
<table>
<colgroup>
<col width="24%"></col>
<col width="75%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rmDup</td>
<td>Set rmDup = TRUE if user want to remove some samples such as duplicates. Set rmDup = FALSE if user want to keep all samples.</td>
</tr>
<tr class="even">
<td>mode</td>
<td>Specify which of the five parts need to be run, e.g. mode = 0 makes that all R/Rmd/sh files are generated for other parts. When mode = 1, all csv files in the GGIR output directory were read, transformed and then merged. When mode = 2, the GGIR output files were checked and summarized in one excel sheet. When mode = 3, the merged data was cleaned according to the number of valid hours on each night and the number of valid days for each subject. When mode = 4, the cleaned data was imputed.</td>
</tr>
</tbody>
</table>
</div>
<div id="run-script-in-a-cluster" class="section level2">
<h2>Run script in a cluster</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#$ -cwd</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#$ -j y</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#$ -S /bin/bash</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  source <span class="op">~</span><span class="er">/</span>.bash_profile</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>   cd <span class="op">/</span>postGGIR<span class="op">/</span>inst<span class="op">/</span>example<span class="op">/</span>afterGGIR; </span>
<span id="cb6-9"><a href="#cb6-9"></a>   module load R ; </span>
<span id="cb6-10"><a href="#cb6-10"></a>     R <span class="op">--</span>no<span class="op">-</span>save <span class="op">--</span>no<span class="op">-</span>restore <span class="op">--</span>args  <span class="op">&lt;</span><span class="st"> </span>studyname_ggir9s_postGGIR.pipeline.maincall.R  <span class="dv">0</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>     R <span class="op">--</span>no<span class="op">-</span>save <span class="op">--</span>no<span class="op">-</span>restore <span class="op">--</span>args  <span class="op">&lt;</span><span class="st"> </span>studyname_ggir9s_postGGIR.pipeline.maincall.R  <span class="dv">1</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>     R <span class="op">--</span>no<span class="op">-</span>save <span class="op">--</span>no<span class="op">-</span>restore <span class="op">--</span>args  <span class="op">&lt;</span><span class="st"> </span>studyname_ggir9s_postGGIR.pipeline.maincall.R  <span class="dv">2</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>     R <span class="op">--</span>no<span class="op">-</span>save <span class="op">--</span>no<span class="op">-</span>restore <span class="op">--</span>args  <span class="op">&lt;</span><span class="st"> </span>studyname_ggir9s_postGGIR.pipeline.maincall.R  <span class="dv">3</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>     R <span class="op">--</span>no<span class="op">-</span>save <span class="op">--</span>no<span class="op">-</span>restore <span class="op">--</span>args  <span class="op">&lt;</span><span class="st"> </span>studyname_ggir9s_postGGIR.pipeline.maincall.R  <span class="dv">4</span> </span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a>     R <span class="op">-</span>e <span class="st">&quot;rmarkdown::render(&#39;part5_studyname_postGGIR.report.Rmd&#39;   )&quot;</span> </span>
<span id="cb6-17"><a href="#cb6-17"></a>     R <span class="op">-</span>e <span class="st">&quot;rmarkdown::render(&#39;part6_studyname_postGGIR.nonwear.report.Rmd&#39;   )&quot;</span> </span>
<span id="cb6-18"><a href="#cb6-18"></a>     R <span class="op">-</span>e <span class="st">&quot;rmarkdown::render(&#39;part7a_studyname_postGGIR_JIVE_1_somefeatures.Rmd&#39;   )&quot;</span> </span>
<span id="cb6-19"><a href="#cb6-19"></a>     R <span class="op">-</span>e <span class="st">&quot;rmarkdown::render(&#39;part7b_studyname_postGGIR_JIVE_2_allfeatures.Rmd&#39;   )&quot;</span> </span>
<span id="cb6-20"><a href="#cb6-20"></a>     R <span class="op">-</span>e <span class="st">&quot;rmarkdown::render(&#39;part7c_studyname_postGGIR_JIVE_3_excelReport.Rmd&#39;   )&quot;</span> </span></code></pre></div>
</div>
</div>
<div id="inspecting-the-results" class="section level1">
<h1>Inspecting the results</h1>
<div id="output-of-part-0" class="section level2">
<h2>Output of part 0</h2>
<ul>
<li>Command = call.afterggir(mode=0)</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="22%"></col>
<col width="77%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part1_data.transform.R (use.cluster=TRUE, optional)</td>
<td>R code for data transformation and merge for every 20 files in each partition. When the number of .bin files is large ( &gt; 1000), the data merge could take long time, user could split the job and submit the job to a cluster for parallel computing.</td>
</tr>
<tr class="even">
<td>part1_data.transform.sw (use.cluster=TRUE, optional)</td>
<td>Submit the job to a cluster for parallel computing</td>
</tr>
<tr class="odd">
<td>part1_data.transform.merge.sw (use.cluster=TRUE, optional)</td>
<td>Merge all partitions for the ENMO and ANGLEZ data</td>
</tr>
<tr class="even">
<td>part5_studyname_postGGIR.report.Rmd</td>
<td>R markdown file for generate a comprehensive report of data processing and explortatory plots.</td>
</tr>
<tr class="odd">
<td>part6_studyname_postGGIR.nonwear.report.Rmd</td>
<td>R markdown file for generate a report of nonwear score.</td>
</tr>
<tr class="even">
<td>part7a_studyname_postGGIR_JIVE_1_somefeatures.Rmd</td>
<td>Extract some features from the actigraphy data using R</td>
</tr>
<tr class="odd">
<td>part7b_studyname_postGGIR_JIVE_2_allfeatures.Rmd</td>
<td>Extract other features from the GGIR output and merge all features together</td>
</tr>
<tr class="even">
<td>part7c_studyname_postGGIR_JIVE_3_excelReport.Rmd</td>
<td>Combine all features into one single excel file. This is optional since it might be killed due to the issue of out of memory in a cluster.</td>
</tr>
<tr class="odd">
<td>part7d_studyname_postGGIR_JIVE_4_outputReport.Rmd</td>
<td>Perform JIVE Decomposition for All Features using r.jive</td>
</tr>
<tr class="even">
<td>part9_swarm.sh</td>
<td>shell script to submit all jobs to the cluster</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-1" class="section level2">
<h2>Output of part 1</h2>
<ul>
<li>Command = call.afterggir(mode=1)</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="26%"></col>
<col width="73%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>studyname_filesummary_csvlist.csv</td>
<td>File list in the ./csv folder of GGIR</td>
</tr>
<tr class="even">
<td>studyname_filesummary_Rdatalist.csv</td>
<td>File list in the ./basic folder of GGIR</td>
</tr>
<tr class="odd">
<td>All_studyname_ANGLEZ.data.csv</td>
<td>Raw data of ANGLEZ after merge</td>
</tr>
<tr class="even">
<td>All_studyname_ENMO.data.csv</td>
<td>Raw data of ENMO after merge</td>
</tr>
<tr class="odd">
<td>nonwearscore_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of nonwearscore</td>
</tr>
<tr class="even">
<td>nonwearscore_studyname_f0_f1_Xs.pdf</td>
<td>Plots for nonwearscore</td>
</tr>
<tr class="odd">
<td>plot.nonwearVSnvalidhours.csv</td>
<td>Nonwear data for plot</td>
</tr>
<tr class="even">
<td>plot.nonwearVSnvalidhours.pdf</td>
<td>Nonwear plots</td>
</tr>
<tr class="odd">
<td>lightmean_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of lightmean</td>
</tr>
<tr class="even">
<td>lightpeak_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of lightpeak</td>
</tr>
<tr class="odd">
<td>temperaturemean_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of temperaturemean</td>
</tr>
<tr class="even">
<td>clippingscore_studyname_f0_f1_Xs.csv</td>
<td>Raw data of clippingscore</td>
</tr>
<tr class="odd">
<td>EN_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of EN</td>
</tr>
</tbody>
</table>
<p><em>f0 and f1 are the file index to start and finish with<br />
</em>Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output</p>
</div>
<div id="output-of-part-2" class="section level2">
<h2>Output of part 2</h2>
<ul>
<li>Command = call.afterggir(mode=1)</li>
<li>Output folder = ./summary</li>
</ul>
<table>
<colgroup>
<col width="25%"></col>
<col width="74%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>studyname_ggir_output_summary.xlsx</td>
<td>Description of all accelerometer files in the GGIR output. This excel file includs 9 pages as follows, (1) List of files in the GGIR output (2) Summary of files (3) List of duplicate IDs (4) ID errors (5) Number of valid days (6) Table of number of valid/missing days (7) Missing patten (8) Frequency of the missing pattern (9) Description of all accelerometer files.</td>
</tr>
<tr class="even">
<td>part2daysummary.info.csv</td>
<td>Intermediate results for description of each accelerometer file.</td>
</tr>
<tr class="odd">
<td>studyname_ggir_output_summary_plot.pdf</td>
<td>Some plots such as the number of valid days, which were included in the part2a_studyname_postGGIR.report.html file as well.</td>
</tr>
<tr class="even">
<td>studyname_samples_remove_temp.csv</td>
<td>Create studyname_samples_remove.csv file by filling “remove” in the “duplicate” column in this template. If duplicate=“remove”, the accelerometer files will not be used in the data analysis of part5.</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-3" class="section level2">
<h2>Output of part 3</h2>
<ul>
<li>Command = call.afterggir(mode=1)</li>
<li>Output folder = ./data</li>
</ul>
<table>
<colgroup>
<col width="26%"></col>
<col width="73%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flag_All_studyname_ANGLEZ.data.Xs.csv</td>
<td>Adding flags for data cleaning of the raw ANGLEZ data</td>
</tr>
<tr class="even">
<td>flag_All_studyname_ENMO.data.Xs.csv</td>
<td>Adding flags for data cleaning of the raw ENMO data</td>
</tr>
<tr class="odd">
<td>IDMatrix.flag_All_studyname_ENMO.data.60s.csv</td>
<td>ID matrix</td>
</tr>
</tbody>
</table>
<p>*Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output</p>
</div>
<div id="output-of-part-4" class="section level2">
<h2>Output of part 4</h2>
<ul>
<li>Command = call.afterggir(mode=1)</li>
<li>Output folder = ./data</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>impu.flag_All_studyname_ENMO.data.60s.csv</td>
<td>Imputation data for the merged ENMO data, and the missing values were imputated by the average ENMO over all the valid days for each subject.</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-5" class="section level2">
<h2>Output of part 5</h2>
<ul>
<li>Command = part5_studyname_postGGIR.report.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part5_studyname_postGGIR.report.html</td>
<td>A comprehensive report of data processing and explortatory plots.</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-6" class="section level2">
<h2>Output of part 6</h2>
<ul>
<li>Command = part6_studyname_postGGIR.nonwear.report.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="12%"></col>
<col width="12%"></col>
<col width="74%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Folder</th>
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>./</td>
<td>part6_studyname_postGGIR.nonwear.report.html</td>
<td>A report of nonwear score.</td>
</tr>
<tr class="even">
<td>./data</td>
<td>JIVEraw_nonwearscore_studyname_f0_f1_Xs.csv</td>
<td>Imputation data matrix of nonwearscore (1/0)</td>
</tr>
<tr class="odd">
<td>./data</td>
<td>JIVEimpu_nonwearscore_studyname_f0_f1_Xs.csv</td>
<td>Data matrix of nonwearscore (1/0/NA)</td>
</tr>
</tbody>
</table>
<p><em>f0 and f1 are the file index to start and finish with<br />
</em>Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output</p>
</div>
<div id="output-of-part-7a" class="section level2">
<h2>Output of part 7a</h2>
<ul>
<li>Command = part7a_studyname_postGGIR_JIVE_1_somefeatures.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part7_studyname_all_features_dictionary.xlsx</td>
<td>Description of features</td>
</tr>
<tr class="even">
<td>part7a_studyname_postGGIR_JIVE_1_somefeatures.html</td>
<td>Extract some features from the actigraphy data using R</td>
</tr>
<tr class="odd">
<td>part7a_studyname_some_features_page1_features.csv</td>
<td>List of some features</td>
</tr>
<tr class="even">
<td>part7a_studyname_some_features_page2_face_day_PCs.csv</td>
<td>Function PCA at the day level using fpca.face( )</td>
</tr>
<tr class="odd">
<td>part7a_studyname_some_features_page3_face_subject_PCs.csv</td>
<td>Function PCA at the subject level using fpca.face( )</td>
</tr>
<tr class="even">
<td>part7a_studyname_some_features_page4_denseFLMM_day_PCs.csv</td>
<td>Function PCA at the day level using denseFLMM( )</td>
</tr>
<tr class="odd">
<td>part7a_studyname_some_features_page5_denseFLMM_subject_PCs.csv</td>
<td>Function PCA at the subject level using denseFLMM( )</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-7b" class="section level2">
<h2>Output of part 7b</h2>
<ul>
<li>Command = part7b_studyname_postGGIR_JIVE_2_allfeatures.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part7b_studyname_postGGIR_JIVE_2_allfeatures.html</td>
<td>Extract other features from the GGIR output and merge all features together</td>
</tr>
<tr class="even">
<td>part7b_studyname_all_features_1.csv</td>
<td>Raw data of all features</td>
</tr>
<tr class="odd">
<td>part7b_studyname_all_features_2.csv</td>
<td>Keep sample with valid ENMO inputs</td>
</tr>
<tr class="even">
<td>part7b_studyname_all_features_2.csv.log</td>
<td>Log file of each variable of part5b_studyname_all_features_2.csv</td>
</tr>
<tr class="odd">
<td>plot_part7b_studyname_all_features_2.csv.pdf</td>
<td>Plot of each variable of part5b_studyname_all_features_2.csv</td>
</tr>
<tr class="even">
<td>part7b_studyname_all_features_3.csv</td>
<td>Average variable at the subject level</td>
</tr>
<tr class="odd">
<td>part7b_studyname_all_features_3.csv.log</td>
<td>Log file of each variable of part5b_studyname_all_features_3.csv</td>
</tr>
<tr class="even">
<td>plot_part7b_studyname_all_features_3.csv.pdf</td>
<td>Plot of each variable of part5b_studyname_all_features_3.csv</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-7c" class="section level2">
<h2>Output of part 7c</h2>
<ul>
<li>Command = part7c_studyname_postGGIR_JIVE_3_excelReport.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part7c_studyname_postGGIR_JIVE_3_excelReport.html</td>
<td>Combine all features into one single excel file. This is optional since it might be killed due to the issue of out of memory in a cluster.</td>
</tr>
</tbody>
</table>
</div>
<div id="output-of-part-7d" class="section level2">
<h2>Output of part 7d</h2>
<ul>
<li>Command = part7d_studyname_postGGIR_JIVE_4_outputReport.Rmd</li>
<li>Output folder = ./</li>
</ul>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>part7d_studyname_postGGIR_JIVE_4_outputReport.html</td>
<td>Perform JIVE Decomposition for All Features using r.jive</td>
</tr>
<tr class="even">
<td>part7d_studyname_jive_Decomposition.csv</td>
<td>Joint and individual structure estimates</td>
</tr>
<tr class="odd">
<td>part7d_studyname_jive_predScore.csv</td>
<td>PCA scores of JIVE ( missing when jive.predict failes)</td>
</tr>
</tbody>
</table>
</div>
<div id="description-of-variables-in-the-output-data" class="section level2">
<h2>Description of variables in the output data</h2>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>filename</td>
<td>accelerometer file name</td>
</tr>
<tr class="even">
<td>Date</td>
<td>date recored from the GGIR part2.summary file</td>
</tr>
<tr class="odd">
<td>id</td>
<td>IDs recored from the GGIR part2.summary file</td>
</tr>
<tr class="even">
<td>calender_date</td>
<td>date in the format of yyyy-mm-dd</td>
</tr>
<tr class="odd">
<td>N.valid.hours</td>
<td>number of hours with valid data recored from the part2_daysummary.csv file in the GGIR output</td>
</tr>
<tr class="even">
<td>N.hours</td>
<td>number of hours of measurement recored from the part2_daysummary.csv file in the GGIR output</td>
</tr>
<tr class="odd">
<td>weekday</td>
<td>day of the week-Day of the week</td>
</tr>
<tr class="even">
<td>measurementday</td>
<td>day of measurement-Day number relative to start of the measurement</td>
</tr>
<tr class="odd">
<td>newID</td>
<td>new IDs defined as the user-defined function of filename2id(), e.g. substrings of the filename</td>
</tr>
<tr class="even">
<td>Nmiss_c9_c31</td>
<td>number of NAs from the 9th to 31th column in the part2_daysummary.csv file in the GGIR output</td>
</tr>
<tr class="odd">
<td>missing</td>
<td>“M” indicates missing for an invalid day, and “C” indicates completeness for a valid day</td>
</tr>
<tr class="even">
<td>Ndays</td>
<td>number of days of measurement</td>
</tr>
<tr class="odd">
<td>ith_day</td>
<td>rank of the measurementday, for example, the value is 1,2,3,4,-3,-2,-1 for measurementday = 1,…,7</td>
</tr>
<tr class="even">
<td>Nmiss</td>
<td>number of missing (invalid) days</td>
</tr>
<tr class="odd">
<td>Nnonmiss</td>
<td>number of non-missing (valid) days</td>
</tr>
<tr class="even">
<td>misspattern</td>
<td>indicators of missing/nonmissing for all measurement days at the subject level</td>
</tr>
<tr class="odd">
<td>RowNonWear</td>
<td>number of columnns in the non-wearing matrix</td>
</tr>
<tr class="even">
<td>NonWearMin</td>
<td>number of minutes of non-wearing</td>
</tr>
<tr class="odd">
<td>remove16h7day</td>
<td>indicator of a key qulity control output. If remove16h7day=1, the day need to be removed. If remove16h7day=0, the day need to be kept.</td>
</tr>
<tr class="even">
<td>duplicate</td>
<td>If duplicate=“remove”, the accelerometer files will not be used in the data analysis of part5.</td>
</tr>
<tr class="odd">
<td>ImpuMiss.b</td>
<td>number of missing values on the ENMO data before imputation</td>
</tr>
<tr class="even">
<td>ImpuMiss.a</td>
<td>number of missing values on the ENMO data after imputation</td>
</tr>
<tr class="odd">
<td>KEEP</td>
<td>The value is “keep”/“remove”, e.g. KEEP=“remove” if remove16h7day=1 or duplicate=“remove” or ImpuMiss.a&gt;0</td>
</tr>
</tbody>
</table>
</div>
<div id="description-of-features-of-domains-of-physical-activity-sleep-and-circadian-rhythmicity" class="section level2">
<h2>Description of features of domains of physical activity, sleep and circadian rhythmicity</h2>
<p><strong>Sleep Domain</strong></p>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Variable Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>acc_onset</td>
<td>Detected onset of sleep expressed as hours since the previous midnight</td>
</tr>
<tr class="even">
<td>acc_wake</td>
<td>Detected onset of sleep expressed as hours since the previous midnight</td>
</tr>
<tr class="odd">
<td>acc_dur_sibd</td>
<td>Accumulated sustained inactivty bouts during the day. These are the periods we would label during the night as sleep, but during the day they form a subclass of inactivity, which may represent day time sleep or wakefulness while being motionless for a sustained period of time</td>
</tr>
<tr class="even">
<td>acc_n_noc</td>
<td>Number of noturnal sleep periods, with nocturnal referring to the Sleep Period</td>
</tr>
<tr class="odd">
<td>acc_SleepDurationInSpt</td>
<td>Total sleep duration, which equals the accumulated nocturnal sustained inactivity bouts within the Sleep Period Time</td>
</tr>
<tr class="even">
<td>sleep_Midpoint</td>
<td>Sleep Midpoint</td>
</tr>
<tr class="odd">
<td>sleep_efficiency</td>
<td>Slee Efficiency</td>
</tr>
<tr class="even">
<td>N_atleast5minwakenight</td>
<td>Number of times awake during the night for at least 5 minutes</td>
</tr>
<tr class="odd">
<td>ACC_nightsleep_mg</td>
<td>Average acceleration during sleep (mg)</td>
</tr>
<tr class="even">
<td>Nblocks_nightsleep</td>
<td>Number of blocks of night sleep</td>
</tr>
</tbody>
</table>
<p><strong>Physical Activity Domain</strong></p>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Variable Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TAC</td>
<td>Total volume of physical activity</td>
</tr>
<tr class="even">
<td>TLAC</td>
<td>Total volume of physical activity logtransform</td>
</tr>
<tr class="odd">
<td>time</td>
<td>Time related feature from Time_long function</td>
</tr>
<tr class="even">
<td>dur_TINday_min</td>
<td>Total duration of day in minutes spent in total inactivity during the day</td>
</tr>
<tr class="odd">
<td>dur_TSIBday_min</td>
<td>Total duration of day in minutes of sustained inactivity during the day</td>
</tr>
<tr class="even">
<td>dur_TOINday_min</td>
<td>Total duration of day in minutes of other inactivity during the day</td>
</tr>
<tr class="odd">
<td>dur_TLIGday_min</td>
<td>Total duration of day in minutes of light activity during the day</td>
</tr>
<tr class="even">
<td>dur_TMODday_min</td>
<td>Total duration of day in minutes of moderate activity during the day</td>
</tr>
<tr class="odd">
<td>dur_TVIGday_min</td>
<td>Total duration of day in minutes of vigorous activity during the day</td>
</tr>
<tr class="even">
<td>dur_MVPA_D10T125_min</td>
<td>Total duration in minutes of Moderate and Vigorous Physical Activity (MVPA) for bouts 10 minutes or more over 125mg</td>
</tr>
<tr class="odd">
<td>dur_MVPA_D5T125_min</td>
<td>Total duration in minutes of Moderate and Vigorous Physical Activity (MVPA) for bouts 5 minutes or more over 125mg</td>
</tr>
<tr class="even">
<td>dur_MVPA_D1T125_min</td>
<td>Total duration in minutes of Moderate and Vigorous Physical Activity (MVPA) for bouts 1 minutes or more over 125mg</td>
</tr>
<tr class="odd">
<td>Nbouts_INB_D10T50</td>
<td>Number of bouts of inactivity less than 50mg that are between 10-19.99 minutes long</td>
</tr>
<tr class="even">
<td>Nbouts_INB_D20T50</td>
<td>Number of bouts of inactivity less than 50mg that are between 20-29.99 minutes long</td>
</tr>
<tr class="odd">
<td>Nbouts_INB_D30T50</td>
<td>Number of bouts of inactivity less than 50mg that are greater than 30 minutes</td>
</tr>
<tr class="even">
<td>Nbouts_LIGB_D1T50_125</td>
<td>Number of bouts of light activity between 50mg to 125mg that are between 1-4.99 minutes long</td>
</tr>
<tr class="odd">
<td>Nbouts_LIGB_D5T50_125</td>
<td>Number of bouts of light activity between 50mg to 125mg that are between 5-9.99 minutes long</td>
</tr>
<tr class="even">
<td>Nbouts_LIGB_D10T50_125</td>
<td>Number of bouts of light activity between 50mg to 125mg that are greater than 10 minutes</td>
</tr>
<tr class="odd">
<td>Nbouts_MVPA_D1T125</td>
<td>Number of bouts in Moderate to Vigorous Physical Activity over 125mg that are between 1-4.99 minutes</td>
</tr>
<tr class="even">
<td>Nbouts_MVPA_D5T125</td>
<td>Number of bouts in Moderate to Vigorous Physical Activity over 125mg that are between 5-9.99 minutes</td>
</tr>
<tr class="odd">
<td>Nbouts_MVPA_D10T125</td>
<td>Number of bouts in Moderate to Vigorous Physical Activity over 125mg that are 10 minutes or longer</td>
</tr>
<tr class="even">
<td>Nblocks_TINday</td>
<td>Number of blocks of total inactivity during day</td>
</tr>
<tr class="odd">
<td>Nblocks_TSIBday</td>
<td>Number of blocks of total sustained inactivity during day</td>
</tr>
<tr class="even">
<td>Nblocks_TOINday</td>
<td>Number of blocks of total other inactivity during day</td>
</tr>
<tr class="odd">
<td>Nblocks_TLIGday</td>
<td>Number of blocks of total light activity during day</td>
</tr>
<tr class="even">
<td>Nblocks_TMODday</td>
<td>Number of blocks of total moderate activity during day</td>
</tr>
<tr class="odd">
<td>Nblocks_TVIGday</td>
<td>Number of blocks of total vigorous activity during day</td>
</tr>
<tr class="even">
<td>L5TIME_num</td>
<td>Time of the lowest acceleration value of the lowest acceleration 5 hours</td>
</tr>
<tr class="odd">
<td>M10TIME_num</td>
<td>Time of the highest acceleration value of the highest acceleration 10 hours</td>
</tr>
<tr class="even">
<td>L5VALUE</td>
<td>Acceleration value (mg) of the lowest acceleration 5 hours</td>
</tr>
<tr class="odd">
<td>M10VALUE</td>
<td>Acceleration value (mg) of the lowest acceleration value in highest acceleration 10 hours</td>
</tr>
</tbody>
</table>
<p><strong>Circadian Rhythmicity Domain</strong></p>
<table>
<colgroup>
<col width="14%"></col>
<col width="85%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Variable Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RA_ggir</td>
<td>Relative amplitutde: (M10-L5)/(M10+L5) where M10= most active 10 hrs, L5 = least active 5 hour. Calculated by Part5.summary file</td>
</tr>
<tr class="even">
<td>RA</td>
<td>Relative amplitutde: (M10-L5)/(M10+L5) where M10= most active 10 hrs, L5 = least active 5 hour. Calculated by Junrui’s R code</td>
</tr>
<tr class="odd">
<td>IV</td>
<td>Intra-daily variability measures fragmentation in the rest/activity rhythms</td>
</tr>
<tr class="even">
<td>amp_L</td>
<td>amplitude(a measure of variability around the mean)</td>
</tr>
<tr class="odd">
<td>alpha_L</td>
<td>alpha parameter (the relative width of the diurnal curve</td>
</tr>
<tr class="even">
<td>beta_L</td>
<td>beta parameter (the steepness of the morning rise and evening fall of the diurnal curve</td>
</tr>
<tr class="odd">
<td>acro_L</td>
<td>acrophase (the timing of the peak activity)</td>
</tr>
<tr class="even">
<td>F_imp_L</td>
<td>F-statistics (robustness of the rhythm)</td>
</tr>
<tr class="odd">
<td>PC1</td>
<td>1st principal component score from FPCA</td>
</tr>
<tr class="even">
<td>PC2</td>
<td>2nd principal component score from FPCA</td>
</tr>
<tr class="odd">
<td>PC3</td>
<td>3rd principal component score from FPCA</td>
</tr>
<tr class="even">
<td>PC4</td>
<td>4th principal component score from FPCA</td>
</tr>
</tbody>
</table>
<p>Reference:</p>
<ul>
<li></li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
